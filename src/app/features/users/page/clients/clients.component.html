<div class="h-screen p-6 bg-[#F9F9F9] overflow-auto">

  <!-- Header -->
  <div class="flex justify-between items-center mb-6">
    <div>
      <h1 class="text-2xl font-bold text-[#1F1F1F]">Clientes</h1>
      <p class="text-gray-600">Gestiona los clientes del sistema</p>
    </div>

    <button
      class="flex items-center bg-[#B8672E] text-white px-4 py-2 rounded shadow hover:bg-[#A67C52] transition"
      (click)="openAddClient()"
    >
      <lucide-icon [img]="UserPlus" class="w-5 h-5 mr-2"></lucide-icon>
      Agregar Cliente
    </button>
  </div>

  <!-- Contenedor principal -->
  <div class="bg-white rounded-lg border border-[#E5E5E5] shadow-sm p-6 space-y-6">

    <!-- Título -->
    <h2 class="text-xl font-semibold text-[#1F1F1F]">
      Lista de Clientes
    </h2>

    <!-- Buscador -->
    <div class="relative max-w-md">
      <input
        type="text"
        [(ngModel)]="filterText"
        (ngModelChange)="onSearchChange()"
        placeholder="Buscar por nombre"
        class="w-full border border-[#E5E5E5] rounded-lg px-4 py-2 pl-10
               focus:outline-none focus:ring-1 focus:ring-[#B8672E]"
      />
      <lucide-icon
        [img]="Search"
        class="absolute left-3 top-1/2 -translate-y-1/2 text-gray-400 w-5 h-5"
      ></lucide-icon>
    </div>

    <!-- Tabla -->
    <div class="overflow-x-auto rounded-lg border border-[#E5E5E5]">
      <table class="min-w-full divide-y divide-[#E5E5E5]">
        <thead class="bg-[#F9F9F9]">
          <tr>
            <th class="px-6 py-3 text-left text-xs font-medium text-gray-600 uppercase">Nombre</th>
            <th class="px-6 py-3 text-left text-xs font-medium text-gray-600 uppercase">Nombre Comercial</th>
            <th class="px-6 py-3 text-left text-xs font-medium text-gray-600 uppercase">Email</th>
            <th class="px-6 py-3 text-left text-xs font-medium text-gray-600 uppercase">Teléfono</th>
            <th class="px-6 py-3 text-left text-xs font-medium text-gray-600 uppercase">Fecha Registro</th>
            <th class="px-6 py-3 text-right text-xs font-medium text-gray-600 uppercase">Acciones</th>
          </tr>
        </thead>

        <tbody class="bg-white divide-y divide-[#E5E5E5]">
          <tr *ngFor="let u of users$ | async" class="hover:bg-[#F9F9F9]">
            <td class="px-6 py-4 font-semibold">{{ u.nombre }}</td>

            <td class="px-6 py-4">
              {{ u.nombre_comercial || 'N/A' }}
            </td>

            <td class="px-6 py-4">
              <lucide-icon [img]="Mail" class="inline w-4 h-4 mr-1 text-gray-500"></lucide-icon>
              {{ u.email }}
            </td>

            <td class="px-6 py-4">
              <lucide-icon [img]="Phone" class="inline w-4 h-4 mr-1 text-gray-500"></lucide-icon>
              {{ u.numero_telefono }}
            </td>

            <td class="px-6 py-4 text-sm">
              {{ u.fecha_registro | date:'dd/MM/yyyy' }}
            </td>

            <td class="px-6 py-4 text-right space-x-2">
              <button (click)="onEdit(u)" class="text-gray-500 hover:text-[#B8672E]">
                <lucide-icon [img]="Edit2" class="w-5 h-5"></lucide-icon>
              </button>
              <button (click)="onDelete(u)" class="text-gray-500 hover:text-red-600">
                <lucide-icon [img]="Trash2" class="w-5 h-5"></lucide-icon>
              </button>
            </td>
          </tr>
        </tbody>
      </table>
    </div>

  </div>
</div>

<!-- Modales -->
<add-client
  *ngIf="showAddClient"
  (close)="showAddClient = false"
  (create)="onClientCreated()"
></add-client>

<edit-client
  *ngIf="showEditClient"
  [userId]="selectedUserId"
  (close)="showEditClient = false"
  (update)="loadClients()"
></edit-client>
